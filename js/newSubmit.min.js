var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(g,p,k){g instanceof String&&(g=String(g));for(var t=g.length,q=0;q<t;q++){var y=g[q];if(p.call(k,y,q,g))return{i:q,v:y}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,p,k){g!=Array.prototype&&g!=Object.prototype&&(g[p]=k.value)};
$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(g,p,k,t){if(p){k=$jscomp.global;g=g.split(".");for(t=0;t<g.length-1;t++){var q=g[t];q in k||(k[q]={});k=k[q]}g=g[g.length-1];t=k[g];p=p(t);p!=t&&null!=p&&$jscomp.defineProperty(k,g,{configurable:!0,writable:!0,value:p})}};
$jscomp.polyfill("Array.prototype.find",function(g){return g?g:function(g,k){return $jscomp.findInternal(this,g,k).v}},"es6","es3");$jscomp.polyfill("Object.is",function(g){return g?g:function(g,k){return g===k?0!==g||1/g===1/k:g!==g&&k!==k}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(g){return g?g:function(g,k){var p=this;p instanceof String&&(p=String(p));var q=p.length;for(k=k||0;k<q;k++)if(p[k]==g||Object.is(p[k],g))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(g,p,k){if(null==g)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(p instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return g+""};$jscomp.polyfill("String.prototype.includes",function(g){return g?g:function(g,k){return-1!==$jscomp.checkStringArgs(this,g,"includes").indexOf(g,k||0)}},"es6","es3");
$(function(){function g(){h.push("About this plugin");h.push(new l("name",f.fields.name,"Plugin Name","submit2-name",z({size:32},function(a,b,c){var d=this;this.locked?"undefined"!==typeof c&&c.preventDefault():(d.ajaxLock=a,d.invalid=!0,ajax("release.submit.validate.name",{data:{name:a},method:"POST",success:function(b){d.ajaxLock===a&&(d.invalid=!b.ok,d.reactInput(b.message,b.ok?"form-input-good":"form-input-error"))}}))}),function(){return{valid:!this.invalid,message:"Invalid plugin name: "+this.$getRow().find(".form-input-react").text()}},
!1,"submit"!==f.mode));h.push(new l("shortDesc",f.fields.shortDesc,"Synopsis","submit2-tagline",z({size:64,maxlength:128}),function(){var a=this.getValue();return{valid:a.length>=r.MIN_SHORT_DESC_LENGTH&&a.length<=r.MAX_SHORT_DESC_LENGTH,message:"The length of the synopsis must be within "+r.MIN_SHORT_DESC_LENGTH+" and "+r.MAX_SHORT_DESC_LENGTH+" characters"}}));getAdminLevel()>=PoggitConsts.AdminLevel.REVIEWER&&h.push(new l("official",f.fields.official,"Official?","submit2-official",D,function(){return{valid:!0}}));
h.push(F=new l("description",f.fields.description,"Description","submit2-description",G({cols:72,rows:15}),function(){return{valid:this.getValue().text.length>=r.MIN_DESCRIPTION_LENGTH,message:"The description must be at least "+r.MIN_DESCRIPTION_LENGTH+" characters long"}}));h.push("About this version");h.push(new l("version",f.fields.version,"Version","submit2-version",z({size:10,maxlength:16},function(a,b,c){var d=this;this.locked?"undefined"!==typeof c&&c.preventDefault():ajax("release.submit.validate.version",
{data:{version:a,projectId:f.buildInfo.projectId},method:"POST",success:function(a){d.invalid=!a.ok;d.reactInput(a.message,a.ok?"form-input-good":"form-input-error")}})}),function(){return{valid:!this.invalid,message:"Invalid plugin version: "+this.$getRow().find(".form-input-react").text()}},!0,"edit"===f.mode));h.push(new l("preRelease",f.fields.preRelease,"Pre-release?","submit2-prerelease",D,function(){return{valid:!0}}));"edit"===f.mode&&h.push(new l("outdated",f.fields.outdated,"Outdated?",
"submit2-outdated",D,function(){return{valid:!0}}));"object"===typeof f.fields.changelog&&h.push(new l("changelog",f.fields.changelog,"What's New","submit2-changelog",G({cols:72,rows:8}),function(){return{valid:this.getValue().text.length>=r.MIN_CHANGELOG_LENGTH,message:"The changelog must be at least "+r.MIN_CHANGELOG_LENGTH+" characters long"}}));h.push("Help users find this plugin");h.push(new l("majorCategory",f.fields.majorCategory,"Major Category","submit2-majorcat",I(f.consts.categories,{},
function(a){var b=$("#submit2-minorcats").find(".cbinput");b.removeClass("submit-cb-disabled").children(".submit-cb").prop("disabled",!1);b.filter(function(){var b=this.getElementsByClassName("submit-cb");console.assert(1===b.length);return Number(b[0].value)===Number(a)}).addClass("submit-cb-disabled").find(".submit-cb").prop("disabled",!0)}),function(){return{valid:!0}}));h.push(new l("minorCategories",f.fields.minorCategories,"Minor Categories","submit2-minorcats",J(f.consts.categories),function(){return{valid:!0}}));
h.push(new l("keywords",f.fields.keywords,"Keywords","submit2-keywords",z,function(){var a=this.getValue();if(a.split(" ").length>r.MAX_KEYWORD_COUNT)return{valid:!1,message:"Too many keywords! Only supply up to "+r.MAX_KEYWORD_COUNT+" keywords."};for(var b=0;b<a.length;++b)if(a[b].length>r.MAX_KEYWORD_LENGTH)return{valid:!1,message:'The keyword "'+a[b]+'" is too long. Each keyword should not have more than '+r.MAX_KEYWORD_LENGTH+" characters."};return{valid:!0}}));h.push("About installation");h.push(new l("deps",
f.fields.deps,"Dependencies","submit2-deps",K,function(){return{valid:!0}}));h.push(new l("requires",f.fields.reqrs,"Manual Setup","submit2-requires",L,function(){return{valid:!0}}));h.push(new l("spoons",f.fields.spoons,"Supported APIs","submit2-spoons",M,function(){return{valid:1<=this.getValue().length,message:"There must be at least one supported API version range!"}},!0,"edit"===f.mode&&0!==f.refRelease.state));h.push("Plugin association");h.push(new l("assocParent",f.fields.assocParent,"Associate Release of:",
"submit2-assoc-parent",N,function(){return{valid:!0}}));0<f.assocChildren.length&&h.push(new l("assocChildrenUpdates",f.fields.assocChildren,"Children Associate Releases","submit2-assoc-children-updates",H(f.assocChildren,!0),function(){return{valid:!0}}));h.push("Other details");h.push(new l("license",f.fields.license,"License","submit2-license",O,function(){return{valid:!0}}));h.push(new l("perms",f.fields.perms,"Permissions","submit2-perms",H(f.consts.perms,!0),function(){return{valid:!0}}));h.push(E=
new l("authors",f.fields.authors,"Producers","submit2-authors",P,function(){return{valid:this.getValue().length>=E.type.minRows,message:"There must be at least 1 producer!"}}));t(F);setTimeout(q,500,E);var b=$(".form-table");b.empty();for(var a=0;a<h.length;++a)h[a].constructor===String?$("<div class='form-subtitle'></div>").append($("<span></span>").text(h[a])).appendTo(b):h[a].constructor===l&&h[a].appendTo(b);for(a=0;a<h.length;++a)h[a].constructor===l&&h[a].setDefaults();$("#submit2-assoc-children-updates").find("input.submit-cb").prop("checked",
!0);b.append($("<div class='form-row'></div>").append("<div class='form-key'>Icon</div>").append($("<div class='form-value'></div>").html(f.icon.html)).append($("<div class='form-icon-preview'></div>").append($("<img/>").attr("src",null===f.icon.url?getRelativeRootPath()+"res/defaultPluginIcon2.png":f.icon.url))));a=$("<div class='submit-buttons'></div>");var c=null,e=null;"edit"!==f.mode?(c=null!==f.last?"Submit Update":"Submit Plugin",e="Save as Draft"):0===f.refRelease.state?(c=null!==f.last?"Submit Update from Draft":
"Submit Plugin from Draft",e="Save Edit"):2===f.refRelease.state?(c="Save Edit",e="Restore to Draft"):c="Save Edit";null!==c&&a.append($("<span class='action-red'></span>").text(c).click(function(){p("submit")}));null!==e&&a.append($("<span class='action-red'></span>").text(e).click(function(){p("draft")}));a.appendTo(b)}function p(b){var a=!1;$(".submit-deps-version").each(function(){"undefined"===typeof $(this).attr("data-relid")&&(alert("You haven't selected the version in one of the dependencies yet!"),
a=!0)});if(!a)if(0<$("#submit-assoc-parent-name").val().length&&"undefined"===typeof $("#submit-assoc-parent-version").attr("data-relid"))alert("You haven't selected the version for the associate release parent yet!");else{var c=$("#wait-spinner");c.modal();for(var e=0;e<h.length;++e)if(h[e].constructor===l&&!h[e].locked){var d=h[e].validator.call(h[e]);if(!d.valid){c.modal("hide");if("submit"===b){alert("Cannot submit due to a problem in "+h[e].name+":\n\n"+d.message);return}if(!confirm("Warning: This plugin cannot be submitted due to a problem in "+
h[e].name+":\n\n"+d.message+"\n\nDo you still want to save this draft?"))return}}b={form:y(),action:b,submitFormToken:f.submitFormToken};ajax("submit.new.ajax",{method:"POST",data:JSON.stringify(b),success:function(a){a.status?window.location=a.link:(c.modal("hide"),alert(a.error))},error:function(a){c.modal("hide");a=JSON.parse(a.responseText);alert(a.error)}})}}function k(b,a){if("object"===typeof a)for(var c in a)a.hasOwnProperty(c)&&("boolean"===typeof a[c]?b.prop(c,a[c]):b.attr(c,a[c]))}function t(b){ghApi("search/code?q="+
encodeURIComponent("readme in:path repo:"+f.repoInfo.full_name),{},"GET",function(a){a=a.items;var c=f.buildInfo.path;a.sort(function(a,b){var d=a.path.substring(0,c.length)===c,e=b.path.substring(0,c.length)===c;return d&&e?Math.compare(a.path.length,b.path.length):d!==e?d?-1:1:a.path===a.name?-1:b.path===b.name?1:a.path.localeCompare(b.path)});for(var e=b.$getRow(),d=0;d<a.length;++d){var m=e.find(".form-value-defaults"),v=$("<span class='action form-value-import'></span>");v.text("Import from "+
a[d].path);v.click(function(a){return function(){$.get("https://raw.githubusercontent.com/"+f.repoInfo.full_name+"/"+f.repoInfo.default_branch+"/"+a.path,{},function(a){e.find(".submit-hybrid-content").val(a);e.find(".submit-hybrid-format").val("sm")})}}(a[d]));v.appendTo(m)}})}function q(b){var a=b.$getRow().find(".submit-tableentry-row");a.each(function(){var b=$(this),e=b.find(".submit-authors-name");if(b.prop("data-changed")||b.prop("data-duplicated")){var d=b.find(".submit-authors-name-react"),
m=e.val();b.prop("data-changed",!1).prop("data-duplicated",!1);var v=b.find(".submit-authors-avatar");v.attr("src",getRelativeRootPath()+"res/ghMark.png");d.removeClass("form-input-good form-input-error").html("&nbsp;");if(m.toLowerCase()===f.repoInfo.owner.login.toLowerCase())"User"===f.repoInfo.owner.type?d.addClass("form-input-error").html("&cross; Duplicated producer"):d.addClass("form-input-error").html("&cross; Only users can be added as producers.");else if(1<a.find(".submit-authors-name").filter(function(){return this.value===
m}).length)d.addClass("form-input-error").html("&cross; Duplicated producer"),b.prop("data-duplicated",!0);else if(/^[a-z\d](?:[a-z\d]|-(?=[a-z\d])){0,38}$/i.test(m)){var u=m.toLowerCase();b.attr("data-lock",u);ghApi("users/"+m,{},"GET",function(a){b.attr("data-lock")===u&&("undefined"!==typeof a.avatar_url?"User"!==a.type?d.addClass("form-input-error").html("&cross; Only users can be added as producers. @"+m+" is an "+a.type.toLowerCase()+"."):(v.attr("src",a.avatar_url),d.addClass("form-input-good").html("&checkmark; Found user"+
(null!==a.name?" ("+a.name+")":"")),b.attr("data-uid",a.id)):d.addClass("form-input-error").html("&cross; @"+m+" was not registered on GitHub!"))})}else d.addClass("form-input-error").html("&cross; Invalid username")}});setTimeout(q,500,b)}function y(){for(var b={},a=0;a<h.length;++a)if(h[a].constructor===l&&!h[a].locked){var c=h[a].getValue();null!==c&&(b[h[a].submitKey]=c)}return b}function l(b,a,c,e,d,m,v,u){"function"===typeof d&&(d=d());console.assert("function"===typeof d.appender);console.assert("function"===
typeof d.getter);console.assert("function"===typeof d.setter);console.assert("boolean"===typeof d.afterRemarks);console.assert("function"===typeof m);this.type=d;this.validator=m;this.id=e;this.submitKey=b;this.name=c;this.rem=a.remarks;this.refDefault=a.refDefault;this.srcDefault=a.srcDefault;this.prefSrc="edit"===f.mode?!1:"undefined"===typeof v?!1:v;this.locked="undefined"===typeof u?!1:u;this.isThisFirstEntry=this.constructor.isNextFirstEntry;this.constructor.isNextFirstEntry=!1}function z(b,
a){return{appender:function(c){var e=$("<input/>");e.addClass("submit-textinput");this.locked&&e.prop("disabled",!0);k(e,b);if("function"===typeof a){var d=this;e.on("input",function(b){b=a.call(d,e.val(),e,b);"string"===typeof b&&e.val(b)})}e.appendTo(c)},getter:function(){return this.$getRow().find(".submit-textinput").val()},setter:function(b){var c=this.$getRow().find(".submit-textinput");c.val(b);"function"===typeof a&&a.call(this,b,c,void 0)},afterRemarks:!1}}function D(b){return{appender:function(a){var c=
$("<input type='checkbox'/>");c.addClass("submit-checkinput");this.locked&&c.prop("disabled",!0);k(c,b);c.appendTo(a)},getter:function(){return this.$getRow().find(".submit-checkinput").prop("checked")},setter:function(a){this.$getRow().find(".submit-checkinput").prop("checked",a)},afterRemarks:!1}}function G(b){return{appender:function(a){var c=$("<textarea></textarea>");c.addClass("submit-hybrid-content");this.locked&&c.prop("disabled",!0);k(c,b);c.appendTo(a);c=$("<div></div>");c.append("<label style='padding: 5px;'>Format:</label>");
var e=$("<select style='display: inline-flex;'></select>");e.addClass("submit-hybrid-format");var d=$("<option value='txt'></option>");d.text("Plain Text (you may indent with spaces)");d.appendTo(e);d="https://github.com/"+f.repoInfo.full_name+"/tree/"+f.buildInfo.sha.substring(0,7)+"/";var m=$("<option value='sm'></option>");m.text("Standard Markdown (rendered like README, links relative to "+d+")");m.appendTo(e);m=$("<option value='gfm'></option>");m.text("GFM (rendered like issue comments, links relative to "+
d+")");m.appendTo(e);e.appendTo(c);c.appendTo(a)},getter:function(){var a=this.$getRow();return{text:a.find(".submit-hybrid-content").val(),type:a.find(".submit-hybrid-format").val()}},setter:function(a){var b=this.$getRow();b.find(".submit-hybrid-content").val(a.text);b.find(".submit-hybrid-format").val(a.type)},afterRemarks:!1}}function O(){var b={},a=function(){var a=$("<div id='licenseViewDialog'></div>"),b=$("<div id='licenseDialogLoading'></div>").css("font-size","x-large").text("Loading..."),
d=$("<div id='licenseDialogInner' autofocus></div>").css("display","none");b.appendTo(a);d.appendTo(a);var m=$("<p id='licenseDescription'></p>");m.appendTo(d);var f=$("<div id='licenseMetaDiv'></div>").css("display","flex"),u={permissions:"Permissions",conditions:"Conditions",limitations:"Limitations"},g={};for(x in u)if(u.hasOwnProperty(x)){var h=$("<div class='license-metadata'></div>");$("<div></div>").css("font-weight","bold").text(u[x]).appendTo(h);var k=$("<ul></ul>");g[x]=k;k.appendTo(h);
h.appendTo(f)}f.appendTo(d);var x=$("<pre></pre>");x.appendTo(d);a.dialog({autoOpen:!1,width:Math.min(.8*window.innerWidth,600),modal:!0,height:.8*window.innerHeight,position:modalPosition,open:function(a,b){$(".ui-widget-overlay").bind("click",function(){$("#licenseViewDialog").dialog("close")})}});return{dialogDiv:a,innerLoadingDiv:b,innerDialogDiv:d,ulNames:u,ulList:f,description:m,metadataUls:g,bodyPre:x}};return{appender:function(c){var e=this;this.ready=!1;var d=$("<select></select>").addClass("submit-license-type").append($("<optgroup label='Special'></optgroup>").append($("<option></option>").text("No License").attr("value",
"none")).append($("<option></option>").text("Custom License").attr("value","custom")));var m=$("<optgroup></optgroup>").attr("label","Featured");m.appendTo(d);var f=$("<optgroup></optgroup>").attr("label","Others");f.appendTo(d);d.change(function(){g.css("display","custom"===d.val()?"block":"none");var a="none"===d.val()||"custom"===d.val();k.hasClass("disabled")!==a&&(a?k.addClass("disabled"):k.removeClass("disabled"))}).appendTo(c);var g=$("<textarea></textarea>").addClass("submit-license-custom").css("display",
"none").appendTo(c);var h=a();var k=$("<span></span>").addClass("action disabled").attr("id","licenseView").text("View license details").click(function(){var a=d.val();void 0!==b[a]&&(a=b[a],h.dialogDiv.dialog("option","title",a.name),h.dialogDiv.dialog("open"),h.innerLoadingDiv.css("display","block"),h.innerDialogDiv.css("display","none"),ghApi("licenses/"+a.key,{},"GET",function(a){h.description.text(a.description);for(var b in h.ulNames){var c=h.metadataUls[b],d=a[b];c.empty();for(var e=0;e<d.length;++e)$("<li></li>").text(d[e]).appendTo(c)}h.bodyPre.text(a.body);
h.innerLoadingDiv.css("display","none");h.innerDialogDiv.css("display","block")},void 0,"Accept: application/vnd.github.drax-preview+json"))}).appendTo(c);ghApi("licenses",{},"GET",function(a){a.sort(function(a,b){return a.name.localeCompare(b.name)});for(var c=0;c<a.length;c++){var g=$("<option></option>");g.attr("value",a[c].key);g.attr("data-url",a[c].url);g.text(a[c].name);b[a[c].key]=a[c];"undefined"!==typeof e.wannaSet&&a[c].key===e.wannaSet.type&&(g.prop("selected",!0),k.removeClass("disabled"));
g.appendTo(a[c].featured?m:f)}e.ready=!0;"undefined"!==typeof e.wannaSet&&d.val(e.wannaSet.type)},void 0,"Accept: application/vnd.github.drax-preview+json")},getter:function(){if(!this.ready)return this.wannaSet;var a=this.$getRow(),b=a.find(".submit-license-type").val();return{type:b,custom:"custom"===b?a.find(".submit-license-custom").val():null}},setter:function(a){if(this.ready||"custom"===a.type||"none"===a.type){var b=this.$getRow();b.find(".submit-license-type").val(a.type);"custom"===a.type&&
b.find(".submit-license-custom").val(a.custom)}else this.wannaSet=a},afterRemarks:!1}}function I(b,a,c){return{appender:function(e){var d=$("<select></select>");d.addClass("submit-selinput");this.locked&&d.prop("disabled",!0);for(var m in b)if(b.hasOwnProperty(m)){var f=$("<option></option>");f.attr("value",m);f.text(b[m]);f.appendTo(d)}k(d,a);if("function"===typeof c){var g=this;d.change(function(a){a=c.call(g,d.val(),d,a);"string"===typeof a&&d.val(a)})}d.appendTo(e)},getter:function(){return this.$getRow().find(".submit-selinput").val()},
setter:function(a){this.$getRow().find(".submit-selinput").val(a);"function"===typeof c&&c.call(this,a)},noDefaults:function(){"function"===typeof c&&c.call(this,this.$getRow().find(".submit-selinput").val())},afterRemarks:!1}}function J(b,a,c,e){return{appender:function(d){var f=$("<div></div>");f.addClass("submit-cbgrp-compact");for(var g in b)if(b.hasOwnProperty(g)){var h=$("<div class='cbinput'></div>"),l=$("<input type='checkbox'/>");l.addClass("submit-cb");l.attr("value",g);l.appendTo(h);h.append(b[g]);
h.appendTo(f);this.locked&&l.prop("disabled",!0);k(l,a);k(h,c)}k(f,e);f.appendTo(d)},getter:function(){return this.$getRow().find(".submit-cb:checked").map(function(){return this.value}).get()},setter:function(a){this.$getRow().find(".submit-cb").not(".submit-cb-disabled").each(function(){this.checked=a.map(String).includes(this.value)})},afterRemarks:!1}}function H(b,a){return{afterRemarks:a,appender:function(a){var c=$("<div></div>");c.addClass("submit-expcb-wrapper");for(var d in b)if(b.hasOwnProperty(d)){var f=
$("<div></div>").addClass("submit-expcb-row"),g=$("<div></div>").addClass("cbinput"),h=$("<input type='checkbox'/>").addClass("submit-cb").attr("value",d);h.appendTo(g);this.locked&&h.prop("disabled",!0);g.append("<div class='cblabel'>"+b[d].name+"</div>");g.appendTo(f);$("<div></div>").addClass("remark").text(b[d].description).appendTo(f);f.appendTo(c)}c.appendTo(a)},getter:function(){return this.$getRow().find(".submit-cb:checked").map(function(){return this.value}).get()},setter:function(a){this.$getRow().find(".submit-cb").not(".submit-cb-disabled").each(function(){this.checked=
a.map(String).includes(this.value)})}}}function A(b,a,c,e,d){function f(b,c){var e=$("<tr class='submit-tableentry-row'></tr>");a(e,c);c.locked||(c=$("<td></td>"),$("<span class='action-red'>&cross;</span>").click(function(){b.find(".submit-tableentry-row").length<=d?alert("There must be at least "+d+" rows!"):e.remove()}).appendTo(c),c.appendTo(e));e.appendTo(b);return e}"undefined"===typeof d&&(d=0);return{appender:function(a){var c=$("<table class='submit-tableentry-table'></table>");b(c);for(var e=
0;e<d;++e)f(c,this);c.appendTo(a);this.locked||$("<span class='action'>&plus;</span>").click(function(){f(c,this)}).appendTo(a)},getter:function(){var a=[];this.$getRow().find(".submit-tableentry-row").each(function(){var b=c($(this));null!==b&&a.push(b)});return a},setter:function(a){console.assert(a.constructor===Array,"values passed for "+this.name+" is not array but ",a);var b=this.$getRow().find(".submit-tableentry-table");b.children(".submit-tableentry-row").remove();for(var c=0;c<a.length;++c){var d=
f(b,this);e(d,a[c])}},minRows:d,afterRemarks:!1}}function P(){return A(function(b){$("<tr class='submit-authors-row-default'></tr>").append($("<th>GitHub username</th>").css("width","200px")).append("<th>Type</th>").appendTo(b);var a=f.repoInfo.owner;"User"===a.type&&$("<tr></tr>").append($("<td class='submit-authors-user-cell'></td>").append($("<img height='28' class=submit-authors-avatar'/>").attr("src",a.avatar_url)).append($("<input class='submit-authors-name' size='15' disabled/>").val(a.login)).append($("<div class='submit-authors-name-react form-input-good'>The repo owner is an implicit collaborator</div>"))).append($("<td class='submit-authors-level-cell'></td>").append("<select class='submit-authors-level' disabled><option selected>Collaborator</option></select>")).appendTo(b)},
function(b){$("<td class='submit-authors-user-cell'></td>").append($("<img height='28' class='submit-authors-avatar'/>").attr("src",getRelativeRootPath()+"res/ghMark.png")).append($("<input class='submit-authors-name' size='15'/>").on("input",function(){b.prop("data-changed",!0);b.removeAttr("data-uid")})).append($("<div class='submit-authors-name-react'>&nbsp;</div>")).appendTo(b);var a=$("<select class='submit-authors-level'></select>"),c;for(c in f.consts.authors)if(f.consts.authors.hasOwnProperty(c)){var e=
f.consts.authors[c];$("<option></option>").attr("value",c).text(e).appendTo(a)}$("<td class='submit-authors-level-cell'></td>").append(a).appendTo(b)},function(b){return"undefined"===typeof b.attr("data-uid")?null:{uid:b.attr("data-uid"),name:b.find(".submit-authors-name").val(),level:b.find(".submit-authors-level").val()}},function(b,a){b.attr("data-uid",a.uid);b.prop("data-changed",!0);b.find(".submit-authors-name").val(a.name);b.find(".submit-authors-level").val(a.level)},"Organization"===f.repoInfo.owner.type?
1:0)}function M(){function b(a){for(var b in f.consts.spoons)f.consts.spoons.hasOwnProperty(b)&&$("<option></option>").addClass("submit-spoons-option").attr("value",b).text(b).appendTo(a)}return A($.noop,function(a,c){var e=$("<select class='submit-spoons-start'></select>"),d=$("<select class='submit-spoons-end'></select>");c.locked&&(e.prop("disabled",!0),d.prop("disabled",!0));var g=f.consts.spoons,h=Object.sizeof(g),k=Object.keysToArray(g),l=Object.valuesToArray(g);b(e);b(d);var p=e.children("option"),
n=d.children("option");e.change(function(){var a=k.indexOf(this.value),b=d.val(),c=k.indexOf(b);n.prop("disabled",!1);n.slice(0,a).prop("disabled",!0);for(var e=a;e<h;++e)h===e+1||l[e+1].incompatible?n.eq(e).prop("disabled",!1):n.eq(e).prop("disabled",!0);c<a&&(c=a);if(c+1<g.length&&!l[c+1].incompatible){for(a=c+1;a<h;++a)if(a+1===h||l[a+1].incompatible){c=a;break}console.assert(c===a);b=k[b];d.val(b);d.change()}});d.change(function(){var a=k.indexOf(e.val()),b=k.indexOf(d.val());p.slice(0,b+1).prop("disabled",
!1);p.slice(b+1).prop("disabled",!0);a>b&&e.val(k[b])});e.val(f.consts.promotedSpoon);d.val(Object.keysToArray(f.consts.spoons).slice(-1)[0]);e.wrap("<td></td>").parent().appendTo(a);a.append("<td>&mdash;</td>");d.wrap("<td></td>").parent().appendTo(a)},function(a){return[a.find(".submit-spoons-start").val(),a.find(".submit-spoons-end").val()]},function(a,b){var c=a.find(".submit-spoons-start").val(b[0]);a=a.find(".submit-spoons-end").val(b[1]);c.change();a.change()},1)}function L(){return A(function(b){$("<tr></tr>").append($("<th>Required?</th>").css("width",
"150px")).append($("<th>Type</th>").css("width","250px")).append($("<th>Details</th>").css("width","500px")).appendTo(b)},function(b){var a=$("<select class='submit-requires-type'></select>"),c=$("<input class='submit-requires-details'/>").attr("size",50),e;for(e in f.consts.reqrs)if(f.consts.reqrs.hasOwnProperty(e)){var d=f.consts.reqrs[e].name;$("<option></option>").attr("value",e).text(d).appendTo(a)}a.change(function(){c.attr("placeholder",f.consts.reqrs[this.value].details)}).change();b.append($("<select class='submit-requires-isrequire'></select>").append("<option value='require'>Requirement</option>").append("<option value='enhance'>Enhancement</option>").wrap("<td></td>").parent()).append(a.wrap("<td></td>").parent()).append(c.wrap("<td></td>").parent())},
function(b){return{type:b.find(".submit-requires-type").val(),details:b.find(".submit-requires-details").val(),isRequire:"require"===b.find(".submit-requires-isrequire").val()}},function(b,a){b.find(".submit-requires-type").val(a.type).change();b.find(".submit-requires-details").val(a.details);b.find(".submit-requires-isrequire").val(a.isRequire?"require":"enhance")})}function K(){return A(function(b){$("<tr></tr>").append($("<th>Required?</th>").css("width","100px")).append($("<th>Plugin Name</th>").css("width",
"200px")).append($("<th>Version</th>")).appendTo(b)},function(b){var a=$("<input class='submit-deps-name' size='15'/>"),c=$("<span class='submit-deps-version action'>Choose a version...</span>");a.change(function(){c.text("Choose a version").removeAttr("data-relid")});c.click(function(){B=c;var b=w=Math.random(),d=a.val();n.dialog.dialog("option","title",'Choose a version of "'+a.val()+'"');n.loading.css("display","block");n.error.css("display","none");n.inner.css("display","none");n.dialog.dialog("open");
ajax("submit.deps.getversions",{data:{name:d,owner:"false"},success:function(a){if(b===w)if(0===Object.sizeof(a))n.loading.css("display","none"),n.error.text("There aren't any submitted (and not rejected) plugins on Poggit called "+d).css("display","block");else{n.loading.css("display","none");C=a;n.table.find("tr.submit-deps-version-select-row").remove();for(var c in a)if(a.hasOwnProperty(c)){var e=$("<span></span>").attr("data-timestamp",a[c].submitTime);timeTextFunc.call(e.get()[0]);n.table.prepend($("<tr></tr>").addClass("submit-deps-version-select-row").append($("<td></td>").append($("<input type='radio'/>").addClass("submit-dep-dialog-version-radio").attr("name",
w).attr("data-value",c).prop("checked",!0)).append($("<label></label>").text(a[c].version))).append($("<td></td>").append($("<input type='checkbox' disabled/>").prop("checked",a[c].preRelease))).append($("<td></td>").append(a[c].stateName)).append($("<td></td>").append(e)))}n.inner.css("display","block")}}})});b.append($("<select class='submit-deps-required'></select>").append("<option value='required'>Required</option>").append("<option value='optional'>Optional</option>").wrap("<td></td>").parent()).append(a.wrap("<td></td>").parent()).append(c.wrap("<td></td>").parent())},
function(b){var a=b.find("span.submit-deps-version");return"undefined"===typeof a.attr("data-relid")?null:{name:b.find("input.submit-deps-name").val(),version:a.attr("data-version"),depRelId:Number(a.attr("data-relid")),required:"required"===b.find("select.submit-deps-required").val()}},function(b,a){b.find("input.submit-deps-name").val(a.name);b.find("span.submit-deps-version").text("Change: v"+a.version).attr("data-version",a.version).attr("data-relid",a.depRelId);b.find("select.submit-deps-required").val(a.required?
"required":"optional")})}function N(){return{afterRemarks:!0,appender:function(b){var a=$("<input id='submit-assoc-parent-name' size='15' placeholder='Plugin Name'/>"),c=$("<span id='submit-assoc-parent-version' class='action'>Choose a version...</span>");a.change(function(){c.text("Choose a version").removeAttr("data-relid")});c.click(function(){a.css("border","");if(3>a.val().length)a.css("border","1px solid red");else{var b=w=Math.random();B=c;var d=a.val();n.dialog.dialog("option","title",'Choose a version of "'+
a.val()+'"');n.loading.css("display","block");n.error.css("display","none");n.inner.css("display","none");n.dialog.dialog("open");ajax("submit.deps.getversions",{data:{name:d,owner:"true"},success:function(a){if(b===w)if(0===Object.sizeof(a))n.loading.css("display","none"),n.error.text("You do not own any submitted (and not rejected) plugins on Poggit called "+d).css("display","block");else{n.loading.css("display","none");C=a;var c=!0;n.table.find("tr.submit-deps-version-select-row").remove();for(var e in a)if(a.hasOwnProperty(e)){var f=
$("<span></span>").attr("data-timestamp",a[e].submitTime);timeTextFunc.call(f.get()[0]);n.table.append($("<tr></tr>").addClass("submit-deps-version-select-row").append($("<td></td>").append($("<input type='radio'/>").addClass("submit-dep-dialog-version-radio").attr("name",w).attr("data-value",e).prop("checked",c)).append($("<label></label>").text(a[e].version))).append($("<td></td>").append($("<input type='checkbox' disabled/>").prop("checked",a[e].preRelease))).append($("<td></td>").append(a[e].stateName)).append($("<td></td>").append(f)));
c=!1}n.inner.css("display","block")}}})}});$("<div></div>").css("display","flex").append(a).append(c).appendTo(b)},getter:function(){var b=this.$getRow().find("#submit-assoc-parent-version");return"undefined"===typeof b.attr("data-relid")?null:{releaseId:Number(b.attr("data-relid")),name:this.$getRow().find("submit-assoc-parent-name").val(),version:b.attr("data-version")}},setter:function(b){null!==b&&null!==b.version&&($("#submit-assoc-parent-version").text("Change: v"+b.version).attr("data-version",
b.version).attr("data-relid",b.releaseId),$("#submit-assoc-parent-name").val(b.name))}}}var h=[],r=PoggitConsts.Config,F,E,f;ajax("submit.form",{data:{query:window.location.pathname.substr(getRelativeRootPath().length)},success:function(b){if("error/redirect"===b.action)window.location.replace(b.target),null!==b.message&&alert(b.message);else{var a=$("#body");if("error/bad_query"===b.action)a.html("<h1>400 Bad Request</h1>"),b.text?$("<p></p>").text(b.message).appendTo(a):a.append("<p>"+b.message+
"</p>");else if("error/access_denied"===b.action)a.html("<h1>401 Access Denied</h1>"),b.text?$("<p></p>").text("Details: "+b.message).appendTo(a):a.append("<p>Details:&nbsp;"+b.message+"</p>");else if("error/not_found"===b.action)a.html("<h1>404 Not Found</h1>"),b.text?$("<p></p>").text(b.message).appendTo(a):a.append("<p>"+b.message+"</p>");else if("success"!==b.action)alert("The server returns an unknown result! Please copy (or screenshot) the following data:\n\n"+JSON.stringify(b));else{f=b.submitData;
a=b.submitData.last;document.title=b.title;document.getElementById("submit-title-action").innerHTML=b.actionTitle;generateGhLink(b.treeLink).appendTo(document.getElementById("submit-title-gh"));b=f.args.slice(0,3).join("/");$("<a class='colorless-link' target='_blank'></a>").attr("href",getRelativeRootPath()+"ci/"+b).append($("<img/>").attr("src",getRelativeRootPath()+"ci.badge/"+b+"?build="+f.args[3])).appendTo(document.getElementById("submit-title-badge"));if(null!=a){var c=document.getElementById("submit-intro-last-name");
$("<h5></h5>").text("Updates v"+a.version).append($("<sub></sub>").append($("<a class='colorless-link' target='_blank'></a>").attr("href",getRelativeRootPath()+"ci/"+b+"/"+a.internal).text("Dev Build #"+a.internal+" (&"+a.buildId+")"))).appendTo(c);c.style.display="block"}g()}}},error:function(b){b=b.getResponseHeader("X-Poggit-Request-ID");window.location.replace(getRelativeRootPath()+"500ise.template?id="+b)}});l.isNextFirstEntry=!0;l.prototype.$getRow=function(){return $(document.getElementById(this.id))};
l.prototype.appendTo=function(b){var a=$("<div class='form-row'></div>").attr("id",this.id);$("<div class='form-key'></div>").text(this.name).appendTo(a);var c=$("<span></span>").addClass("explain").html(this.rem),e=$("<div class='form-value'></div>");this.type.afterRemarks?(c.addClass("explain-before-input").appendTo(e),this.type.appender.call(this,e)):(this.type.appender.call(this,e),c.addClass("explain-after-input").appendTo(e));e.appendTo(a);$("<div class='form-input-react'></div>").appendTo(e);
var d=this;if(!this.locked){c=$("<div class='form-value-defaults'></div>");var g=e=null;null!==this.refDefault&&(e=$("<span class='action form-value-import'></span>").text("edit"===f.mode?"Reset":this.isThisFirstEntry?"Copy from last release":"Copy"),e.click(function(){d.type.setter.call(d,d.refDefault)}));null!==this.srcDefault&&(g=$("<span class='action form-value-import'></span>").text(this.isThisFirstEntry?"Detect from code":"Detect"),g.click(function(){d.type.setter.call(d,d.srcDefault)}));this.prefSrc?
(null!==g&&g.appendTo(c),null!==e&&e.appendTo(c)):(null!==e&&e.appendTo(c),null!==g&&g.appendTo(c));c.appendTo(a)}a.appendTo(b)};l.prototype.setDefaults=function(){if(this.prefSrc)if(null!==this.srcDefault)var b=this.srcDefault;else null!==this.refDefault&&(b=this.refDefault);else null!==this.refDefault?b=this.refDefault:null!==this.srcDefault&&(b=this.srcDefault);void 0!==b?this.type.setter.call(this,b):"function"===typeof this.type.noDefaults&&this.type.noDefaults.call(this)};l.prototype.reactInput=
function(b,a){var c=this.$getRow().find(".form-input-react");c.html(b);if("object"===typeof this.classes&&this.classes.constructor===Array)for(b=0;b<this.classes.length;++b)c.removeClass(this.classes[b]);this.classes=[];if("string"===typeof a)this.classes.push(a),c.addClass(a);else if("object"===typeof a&&a.constructor===Array)for(b=0;b<a.length;++b)this.classes.push(a[b]),c.addClass(a[b])};l.prototype.getValue=function(){return this.locked?null:this.type.getter.call(this)};l.prototype.isValid=function(){return this.validator.call(this)};
var B,w,C,n=function(){var b=$("<div id='depSelectDialog'></div>"),a=$("<div></div>").css("font-size","x-large").text("Loading versions..."),c=$("<div></div>").addClass("fallback-error"),e=$("<div></div>");e.append("<p>Select the <strong>recommended</strong> version of the dependency plugin, usually the <em>latest</em> version. You don't need to select older versions; if you want to, mention it in the Description.</p>");e.append("<p>Keep in mind that the state of your plugin will never be higher than the state of your dependencies (except Featured). For example, if your plugin depends on a release that has not been approved yet, your plugin won't get approved either before the dependency release gets approved.</p>");
var d=$("<table></table>");d.append("<tr><th>Version</th><th>Pre-release?</th><th>State on Poggit</th><th>Submission date</th></tr>").appendTo(e);b.append(a).append(c).append(e);b.dialog({autoOpen:!1,width:Math.min(.8*window.innerWidth,600),modal:!0,height:.8*window.innerHeight,position:modalPosition,buttons:{Select:function(){var a=$("input.submit-dep-dialog-version-radio:checked").attr("data-value"),b=C[a].version;B.text("Change: v"+b).attr("data-relid",a).attr("data-version",b);$(this).dialog("close");
C=w=B=void 0}},open:function(a,b){$(".ui-widget-overlay").bind("click",function(){$("#depSelectDialog").dialog("close")})}});return{dialog:b,loading:a,error:c,inner:e,table:d}}()});
