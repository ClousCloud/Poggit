var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,h,c){a instanceof String&&(a=String(a));for(var d=a.length,f=0;f<d;f++){var k=a[f];if(h.call(c,k,f,a))return{i:f,v:k}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,h,c){a!=Array.prototype&&a!=Object.prototype&&(a[h]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,h,c,d){if(h){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];h=h(d);h!=d&&null!=h&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var maxRows=30;
$(function(){function a(b,a){var e=$("<div id='togglewrapper' class='togglewrapper'></div>");e.html("<p>Loading repos...</p>");e.attr("data-name",b);e.attr("data-opened",a?"false":"true");var f=toggleFunc(e);ajax("ci.project.list",{data:{owner:b},success:function(a){console.log(b);var e=$("<table></table>");e.css("width","100%");for(var c in a)if(a.hasOwnProperty(c)){var g=a[c],p=$("<tr></tr>");$("<td></td>").append($("<a></a>").text(g.name.substr(0,14)+(14<g.name.length?"...":"")).attr("href",getRelativeRootPath()+
"ci/"+b+"/"+g.name)).append(generateGhLink("https://github.com/"+b+"/"+g.name)).appendTo(p);$("<td id=prj-"+g.id+"></td>").text(0<g.projectsCount?g.projectsCount:"").appendTo(p);var d=$("<div class='toggle toggle-light' id=btn-"+g.id+"></div>");d.css("float","right");d.text(0===g.projectsCount?"Enable":"Disable");d.toggles({drag:!0,click:!0,text:{on:"ON",off:"OFF"},animate:250,easing:"swing",checkbox:null,clicker:null,type:"compact"});d.toggles(0!==g.projectsCount);d.toggleClass("disabled",!0);d.click(function(a){return function(){var b=
$("#enableRepoBuilds");b.data("repoId",a.id);var e=0===a.projectsCount,g=e?"Enable":"Disable",c="auto";b.data("target",e?"true":"false");e?(h(b,a),$("#confirm").attr("disabled",!0)):(c="300px",b.find("#detailLoader").text("Click Confirm to Disable Poggit-CI for "+a.name),$("#confirm").attr("disabled",!1));b.dialog({title:g+" Poggit-CI",width:c,height:"auto",position:modalPosition});$(".ui-dialog-titlebar button:contains('Close')").prop("title","");b.dialog("open")}}(g));p.append($("<td></td>").append(d));
p.appendTo(e)}$(f).empty().append(e)}});return e}function h(a,c){var b=a.find("#detailLoader");b.text("Loading details...");a=a.dialog("option","buttons");for(var d,g=0;g<a.length;g++){var f=a[g];if("confirm"===f.id){d=f;break}}console.assert("object"===typeof d);ajax("build.scanRepoProjects",{data:{repoId:c.id},success:function(a){a=a.yaml;var g=(a.split(/\r\n|\r|\n/).length<maxRows?a.split(/\r\n|\r|\n/).length:maxRows)-1,e=$("<div class='pluginname'><h3>"+c.name+"</h3></div>");b.empty();e.appendTo(b);
e=$("<div class='cbinput'></div>");var d=$('<input type="checkbox" checked id="manifestEditConfirm">');d.change(function(){document.getElementById("selectManifestFile").disabled=!this.checked;document.getElementById("inputManifestContent").disabled=!this.checked});d.appendTo(e);e.append("Commit default .poggit.yml to the repo");e.appendTo(b);e=$("<p></p>");e.text("After Poggit-CI is enabled for this repo, a manifest file will be created at: ");$("<select id='selectManifestFile'><option value='.poggit.yml' selected>.poggit.yml</option></select>").appendTo(e);
e.appendTo(b);e=$("<div class='manifestarea'>Content of the manifest:<br/></div>");g=$("<textarea id='inputManifestContent' rows='"+g+"'></textarea>");g.text(a);g.appendTo(e);e.appendTo(b);$("#enableRepoBuilds").dialog({position:{my:"center top",at:"center top+100",of:window}});$("#confirm").attr("disabled",!1)},method:"POST"})}function c(a,c){var b={repoId:c.data("repoId"),enabled:c.data("target")},d;"true"===b.enabled&&document.getElementById("manifestEditConfirm").checked&&(d=c.find("#selectManifestFile"))&&
(b.manifestFile=d.val(),b.manifestContent=c.find("#inputManifestContent").val());ajax("ajax.toggleRepo",{data:b,method:"POST",success:function(b){b.enabled?(briefEnabledRepos[b.repoId].projectsCount=b.projectscount,$("#prj-"+b.repoId).text(briefEnabledRepos[b.repoId].projectsCount),$(".ajaxpane").prepend(b.panelhtml),$("#detailLoader").empty()):($("#repo-"+b.repoId).remove(),briefEnabledRepos[b.repoId].projectsCount=0,$("#prj-"+b.repoId).text(briefEnabledRepos[b.repoId].projectsCount));a.dialog("close");
$("#btn-"+b.repoId).toggles(b.enabled);$("#confirm").attr("disabled",!1)}})}var d=$("#inputSearch"),f=$("#inputUser"),k=$("#inputRepo"),m=$("#inputProject"),n=$("#inputBuild"),y=$("#gotoRecent"),z=$("#gotoAdmin"),A=$("#gotoSelf"),v=$("#gotoSearch"),q=$("#gotoUser"),r=$("#gotoRepo"),t=$("#gotoProject"),u=$("#gotoBuild"),l=function(){var a=!f.val().trim(),c=!(f.val().trim()&&k.val().trim()),e=!(f.val().trim()&&k.val().trim()&&m.val().trim()),d=!(f.val().trim()&&k.val().trim()&&m.val().trim()&&n.val().trim());
q.hasClass("disabled")!==a&&q.toggleClass("disabled");r.hasClass("disabled")!==c&&r.toggleClass("disabled");t.hasClass("disabled")!==e&&t.toggleClass("disabled");u.hasClass("disabled")!==d&&u.toggleClass("disabled")};if(0!==window.location.hash.length){var w=$("a[name="+window.location.hash.substring(1)+"]").parent().offset();"undefined"!==typeof w&&$("html, body").animate({scrollTop:w.top},300)}f.keydown(function(){setTimeout(l,50)});f.change(l);f.keyup(function(a){13==a.keyCode&&q.click()});d.keydown(function(){setTimeout(l,
50)});d.change(l);d.keyup(function(a){13==a.keyCode&&v.click()});k.keydown(function(){setTimeout(l,50)});k.change(l);k.keyup(function(a){13==a.keyCode&&r.click()});m.keydown(function(){setTimeout(l,50)});m.change(l);m.keyup(function(a){13==a.keyCode&&t.click()});n.keydown(function(){setTimeout(l,50)});n.change(l);n.keyup(function(a){13==a.keyCode&&u.click()});A.click(function(){window.location=getRelativeRootPath()+"ci/"+getLoginName()});z.click(function(){window.location=getRelativeRootPath()+"ci"});
y.click(function(){window.location=getRelativeRootPath()+"ci/recent"});v.click(function(){var a=$("#searchresults");if(""===d.val())a.empty(),a.attr("hidden",!0);else{a.text("Loading Search Results...");var c={search:d.val()};ajax("search.ajax",{data:c,method:"POST",success:function(b){a.empty();a.html(b.html);a.attr("hidden",!1);$("#inputSearch").val("")},error:function(a,b,c){alert(c)}})}});q.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=
getRelativeRootPath()+"ci/"+f.val()});r.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+f.val()+"/"+k.val()});t.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+f.val()+"/"+k.val()+"/"+m.val()});u.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+
f.val()+"/"+k.val()+"/"+m.val()+"/"+$("#inputBuildClass").val()+":"+n.val()});var x=$("#enableRepoBuilds");(function(){var b=$("#toggle-orgs");0!==b.length&&(b.empty(),a(getLoginName(),!1).appendTo(b),ghApi("user/orgs",{},"GET",function(c){for(var d=0;d<c.length;d++)a(c[d].login,!0).appendTo(b)}))})();x.dialog({autoOpen:!1,dialogClass:"no-close",closeOnEscape:!0,close:function(a){a.originalEvent&&$("#detailLoader").empty()},buttons:[{id:"confirm",text:"Confirm",click:function(){$("#confirm").attr("disabled",
!0);c($(this),x)}}],modal:!0});16<$("#recentBuilds > div").length&&"on"===getParameterByName("usePages",!1!==sessionData.opts.usePages?"on":"off")&&$("#recentBuilds").paginate({perPage:16,scope:$("div")});12<$("#repolistbuildwrapper > div").length&&"on"===getParameterByName("usePages",!1!==sessionData.opts.usePages?"on":"off")&&$("#repolistbuildwrapper").paginate({perPage:12,scope:$("div")})});
function testWebhook(a,h){ajax("ci.webhookTest",{data:{owner:a,name:h},success:function(a){console.log(a)}})}function promptDownloadResource(a,h){h=prompt("Filename to download with:",h);null!==h&&(window.location=getRelativeRootPath()+"r/"+a+"/"+h)}var toggleProjectSub=function(a,h){var c=$("#project-subscribe");c.addClass("disabled");c.prop("onclick",null).off("click");ajax("ci.project.togglesub",{data:{projectId:a,level:h},success:function(){window.location.reload(!0)}})};
