var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,k,f){a instanceof String&&(a=String(a));for(var h=a.length,e=0;e<h;e++){var l=a[e];if(k.call(f,l,e,a))return{i:e,v:l}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,k,f){a!=Array.prototype&&a!=Object.prototype&&(a[k]=f.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,k,f,h){if(k){f=$jscomp.global;a=a.split(".");for(h=0;h<a.length-1;h++){var e=a[h];e in f||(f[e]={});f=f[e]}a=a[a.length-1];h=f[a];k=k(h);k!=h&&null!=k&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:k})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,f){return $jscomp.findInternal(this,a,f).v}},"es6","es3");
$(function(){function a(b,a){var d=$("<div id='toggle-wrapper' class='toggle-wrapper'></div>");d.html("<p>Loading repos...</p>");d.attr("data-name",b);d.attr("data-opened",a?"false":"true");var c=toggleFunc(d);ajax("ci.project.list",{data:{owner:b},success:function(a){console.log(b);var d=$("<table></table>");d.css("width","100%");var g={},e;for(e in a)if(a.hasOwnProperty(e)){g.repo=a[e];g.isEnabled=!0===g.repo.build;console.log("repo "+g.repo.name+": ",g.isEnabled);var t=$("<tr></tr>");$("<td></td>").append($("<a></a>").text(g.repo.name.substr(0,
14)+(14<g.repo.name.length?"...":"")).attr("href",getRelativeRootPath()+"ci/"+b+"/"+g.repo.name)).append(generateGhLink("https://github.com/"+b+"/"+g.repo.name)).appendTo(t);$("<td id=prj-"+g.repo.id+"></td>").text(g.isEnabled?g.repo.projectsCount:"").appendTo(t);var m=$("<div class='toggle toggle-light' id=btn-"+g.repo.id+"></div>");m.css("float","right");m.text(g.isEnabled?"Disable":"Enable");m.toggles({drag:!0,click:!0,text:{on:"ON",off:"OFF"},animate:250,easing:"swing",checkbox:null,clicker:null,
type:"compact"});m.toggles(g.isEnabled);m.toggleClass("disabled",!0);m.click(function(b){return function(){var a=$("#enableRepoBuilds");a.data("repoId",b.repo.id);var d=b.isEnabled?"Disable":"Enable",c="auto";a.data("target",b.isEnabled?"false":"true");console.log("Click "+b.repo.name+", ",b.isEnabled);b.isEnabled?(c="300px",a.find("#detailLoader").text("Click Confirm to Disable Poggit-CI for "+b.repo.name+"."),$("#confirm").attr("disabled",!1)):(k(a,b.repo),$("#confirm").attr("disabled",!0));a.dialog({title:d+
" Poggit-CI",width:c,height:"auto",position:modalPosition});$(".ui-dialog-titlebar button:contains('Close')").prop("title","");a.dialog("open")}}(g));t.append($("<td></td>").append(m));t.appendTo(d);g={repo:g.repo,isEnabled:g.isEnabled}}$(c).empty().append(d)}});return d}function k(b,a){var d=b.find("#detailLoader");d.text("Loading details...");b=b.dialog("option","buttons");for(var c,e=0;e<b.length;e++){var f=b[e];if("confirm"===f.id){c=f;break}}console.assert("object"===typeof c);ajax("build.scanRepoProjects",
{data:{repoId:a.id},success:function(b){b=b.yaml;var e=(30>b.split(/\r\n|\r|\n/).length?b.split(/\r\n|\r|\n/).length:30)-1,c=$("<div><h3>"+a.name+"</h3></div>");d.empty();c.appendTo(d);c=$("<div class='cbinput'></div>");var m=$('<input type="checkbox" checked id="manifestEditConfirm">');m.change(function(){document.getElementById("selectManifestFile").disabled=!this.checked;document.getElementById("inputManifestContent").disabled=!this.checked});m.appendTo(c);c.append("Commit default .poggit.yml to the repo");
c.appendTo(d);c=$("<p></p>");c.text("After Poggit-CI is enabled for this repo, a manifest file will be created at: ");$("<select id='selectManifestFile'><option value='.poggit.yml' selected>.poggit.yml</option></select>").appendTo(c);c.appendTo(d);c=$("<div class='manifestarea'>Content of the manifest:<br/></div>");e=$("<textarea id='inputManifestContent' rows='"+e+"'></textarea>");e.text(b);e.appendTo(c);c.appendTo(d);$("#enableRepoBuilds").dialog({position:{my:"center top",at:"center top+100",of:window}});
$("#confirm").attr("disabled",!1)},method:"POST"})}function f(b,a){var d={repoId:a.data("repoId"),enabled:a.data("target")},c;"true"===d.enabled&&document.getElementById("manifestEditConfirm").checked&&(c=a.find("#selectManifestFile"))&&(d.manifestFile=c.val(),d.manifestContent=a.find("#inputManifestContent").val());ajax("ajax.toggleRepo",{data:d,method:"POST",success:function(a){a.success?(a.enabled?($("#prj-"+a.repoId).text(a.projectsCount),$(".toggle-ajax-pane").prepend(a.panelHtml),$("#detailLoader").empty()):
($("#repo-"+a.repoId).remove(),$("#prj-"+a.repoId).text("0")),b.dialog("close"),$("#btn-"+a.repoId).toggles(a.enabled),$("#confirm").attr("disabled",!1)):alert(a.message)}})}var h=$("#inputSearch"),e=$("#inputUser"),l=$("#inputRepo"),p=$("#inputProject"),r=$("#inputBuild"),q=$("#gotoRecent"),B=$("#gotoAdmin"),C=$("#gotoSelf"),D=$("#gotoVirions"),y=$("#gotoSearch"),u=$("#gotoUser"),v=$("#gotoRepo"),w=$("#gotoProject"),x=$("#gotoBuild"),n=function(){var a=!e.val().trim(),c=!(e.val().trim()&&l.val().trim()),
d=!(e.val().trim()&&l.val().trim()&&p.val().trim()),f=!(e.val().trim()&&l.val().trim()&&p.val().trim()&&r.val().trim());u.hasClass("disabled")!==a&&u.toggleClass("disabled");v.hasClass("disabled")!==c&&v.toggleClass("disabled");w.hasClass("disabled")!==d&&w.toggleClass("disabled");x.hasClass("disabled")!==f&&x.toggleClass("disabled")};if(0!==window.location.hash.length){var z=$("a[name="+window.location.hash.substring(1)+"]").parent().offset();"undefined"!==typeof z&&$("html, body").animate({scrollTop:z.top},
300)}"/ci"!==window.location.pathname||sessionData.session.isLoggedIn||window.history.replaceState(null,"","/ci/recent");e.keydown(function(){setTimeout(n,50)});e.change(n);e.keyup(function(a){13===a.keyCode&&u.click()});h.keydown(function(){setTimeout(n,50)});h.change(n);h.keyup(function(a){13===a.keyCode&&y.click()});l.keydown(function(){setTimeout(n,50)});l.change(n);l.keyup(function(a){13===a.keyCode&&v.click()});p.keydown(function(){setTimeout(n,50)});p.change(n);p.keyup(function(a){13===a.keyCode&&
w.click()});r.keydown(function(){setTimeout(n,50)});r.change(n);r.keyup(function(a){13===a.keyCode&&x.click()});C.click(function(){window.location.assign(getRelativeRootPath()+"ci/"+getLoginName())});D.click(function(){window.location.assign(getRelativeRootPath()+"v")});B.click(function(){window.location.assign(getRelativeRootPath()+"ci")});q.click(function(){window.location.assign(getRelativeRootPath()+"ci/recent")});y.click(function(){var a=$("#search-results");if(""===h.val())a.empty(),a.attr("hidden",
!0);else{a.text("Loading Search Results...");var c={search:h.val()};ajax("search.ajax",{data:c,method:"POST",success:function(b){a.empty();a.html(b.html);a.attr("hidden",!1);$("#inputSearch").val("")},error:function(a,b,c){alert(c)}})}});u.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+e.val()});v.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+
"ci/"+e.val()+"/"+l.val()});w.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+e.val()+"/"+l.val()+"/"+p.val()});x.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+e.val()+"/"+l.val()+"/"+p.val()+"/"+$("#inputBuildClass").val()+":"+r.val()});$("#rbp-dl-direct").click(function(a){var b=confirm("This is a development build; it has not been reviewed and may contain dangerous code, including viruses. Do you still want to download this file?");
gaEventCi(!1,!b,this.getAttribute("data-project-name"),this.getAttribute("data-rsr-id"),!1);b||a.preventDefault()});$("#rbp-dl-as").click(function(){var a=this.getAttribute("data-rsr-id"),c=this.getAttribute("data-dl-name"),d=confirm("This is a development build; it has not been reviewed and may contain dangerous code, including viruses. Do you still want to download this file?");gaEventCi(!1,!d,this.getAttribute("data-project-name"),this.getAttribute("data-rsr-id"),!0);d&&(c=prompt("Filename to download with:",
c),null!==c&&(window.location=getRelativeRootPath()+"r/"+a+"/"+c))});$("#toggle-project-sub").click(function(){var a=this.getAttribute("data-project-id"),c=document.getElementById("select-project-sub").value,d=$("#project-subscribe");d.addClass("disabled");d.prop("onclick",null).off("click");ajax("ci.project.togglesub",{data:{projectId:a,level:c},success:function(){window.location.reload(!0)}})});var A=$("#enableRepoBuilds");(function(){var b=$("#toggle-orgs");0!==b.length&&(b.empty(),a(getLoginName(),
!1).appendTo(b),ghApi("user/orgs",{},"GET",function(c){for(var d=0;d<c.length;d++)a(c[d].login,!0).appendTo(b)}))})();A.dialog({autoOpen:!1,dialogClass:"no-close",closeOnEscape:!0,close:function(a){a.originalEvent&&$("#detailLoader").empty()},buttons:[{id:"confirm",text:"Confirm",click:function(){$("#confirm").attr("disabled",!0);f($(this),A)}}],modal:!0});q=$("#recentBuilds");16<q.find("> div").length&&"on"===getParameterByName("usePages",!1!==sessionData.opts.usePages?"on":"off")&&q.paginate({perPage:16,
scope:$("div")});q=$("#repo-list-build-wrapper");12<q.find("> div").length&&"on"===getParameterByName("usePages",!1!==sessionData.opts.usePages?"on":"off")&&q.paginate({perPage:12,scope:$("div")})});
