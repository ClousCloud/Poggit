var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,g,c){a instanceof String&&(a=String(a));for(var f=a.length,b=0;b<f;b++){var h=a[b];if(g.call(c,h,b,a))return{i:b,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,g,c){a!=Array.prototype&&a!=Object.prototype&&(a[g]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,g,c,f){if(g){c=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var b=a[f];b in c||(c[b]={});c=c[b]}a=a[a.length-1];f=c[a];g=g(f);g!=f&&null!=g&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:g})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
$(function(){function a(d,a){var e=$("<div id='toggle-wrapper' class='toggle-wrapper'></div>");e.html("<p>Loading repos...</p>");e.attr("data-name",d);e.attr("data-opened",a?"false":"true");var b=toggleFunc(e);ajax("ci.project.list",{data:{owner:d},success:function(a){console.log(d);var e=$("<table></table>");e.css("width","100%");for(var l in a)if(a.hasOwnProperty(l)){var k=a[l],r=$("<tr></tr>");$("<td></td>").append($("<a></a>").text(k.name.substr(0,14)+(14<k.name.length?"...":"")).attr("href",
getRelativeRootPath()+"ci/"+d+"/"+k.name)).append(generateGhLink("https://github.com/"+d+"/"+k.name)).appendTo(r);$("<td id=prj-"+k.id+"></td>").text(0<k.projectsCount?k.projectsCount:"").appendTo(r);var c=$("<div class='toggle toggle-light' id=btn-"+k.id+"></div>");c.css("float","right");c.text(0===k.projectsCount?"Enable":"Disable");c.toggles({drag:!0,click:!0,text:{on:"ON",off:"OFF"},animate:250,easing:"swing",checkbox:null,clicker:null,type:"compact"});c.toggles(0!==k.projectsCount);c.toggleClass("disabled",
!0);c.click(function(d){return function(){var a=$("#enableRepoBuilds");a.data("repoId",d.id);var e=0===d.projectsCount,l=e?"Enable":"Disable",c="auto";a.data("target",e?"true":"false");e?(g(a,d),$("#confirm").attr("disabled",!0)):(c="300px",a.find("#detailLoader").text("Click Confirm to Disable Poggit-CI for "+d.name+"."),$("#confirm").attr("disabled",!1));a.dialog({title:l+" Poggit-CI",width:c,height:"auto",position:modalPosition});$(".ui-dialog-titlebar button:contains('Close')").prop("title","");
a.dialog("open")}}(k));r.append($("<td></td>").append(c));r.appendTo(e)}$(b).empty().append(e)}});return e}function g(d,a){var e=d.find("#detailLoader");e.text("Loading details...");d=d.dialog("option","buttons");for(var c,b=0;b<d.length;b++){var l=d[b];if("confirm"===l.id){c=l;break}}console.assert("object"===typeof c);ajax("build.scanRepoProjects",{data:{repoId:a.id},success:function(d){d=d.yaml;var c=(30>d.split(/\r\n|\r|\n/).length?d.split(/\r\n|\r|\n/).length:30)-1,b=$("<div><h3>"+a.name+"</h3></div>");
e.empty();b.appendTo(e);b=$("<div class='cbinput'></div>");var l=$('<input type="checkbox" checked id="manifestEditConfirm">');l.change(function(){document.getElementById("selectManifestFile").disabled=!this.checked;document.getElementById("inputManifestContent").disabled=!this.checked});l.appendTo(b);b.append("Commit default .poggit.yml to the repo");b.appendTo(e);b=$("<p></p>");b.text("After Poggit-CI is enabled for this repo, a manifest file will be created at: ");$("<select id='selectManifestFile'><option value='.poggit.yml' selected>.poggit.yml</option></select>").appendTo(b);
b.appendTo(e);b=$("<div class='manifestarea'>Content of the manifest:<br/></div>");c=$("<textarea id='inputManifestContent' rows='"+c+"'></textarea>");c.text(d);c.appendTo(b);b.appendTo(e);$("#enableRepoBuilds").dialog({position:{my:"center top",at:"center top+100",of:window}});$("#confirm").attr("disabled",!1)},method:"POST"})}function c(d,a){var b={repoId:a.data("repoId"),enabled:a.data("target")},c;"true"===b.enabled&&document.getElementById("manifestEditConfirm").checked&&(c=a.find("#selectManifestFile"))&&
(b.manifestFile=c.val(),b.manifestContent=a.find("#inputManifestContent").val());ajax("ajax.toggleRepo",{data:b,method:"POST",success:function(a){a.enabled?($("#prj-"+a.repoId).text(a.projectsCount),$(".ajaxpane").prepend(a.panelHtml),$("#detailLoader").empty()):($("#repo-"+a.repoId).remove(),$("#prj-"+a.repoId).text("0"));d.dialog("close");$("#btn-"+a.repoId).toggles(a.enabled);$("#confirm").attr("disabled",!1)}})}var f=$("#inputSearch"),b=$("#inputUser"),h=$("#inputRepo"),n=$("#inputProject"),q=
$("#inputBuild"),p=$("#gotoRecent"),A=$("#gotoAdmin"),B=$("#gotoSelf"),x=$("#gotoSearch"),t=$("#gotoUser"),u=$("#gotoRepo"),v=$("#gotoProject"),w=$("#gotoBuild"),m=function(){var a=!b.val().trim(),c=!(b.val().trim()&&h.val().trim()),e=!(b.val().trim()&&h.val().trim()&&n.val().trim()),f=!(b.val().trim()&&h.val().trim()&&n.val().trim()&&q.val().trim());t.hasClass("disabled")!==a&&t.toggleClass("disabled");u.hasClass("disabled")!==c&&u.toggleClass("disabled");v.hasClass("disabled")!==e&&v.toggleClass("disabled");
w.hasClass("disabled")!==f&&w.toggleClass("disabled")};if(0!==window.location.hash.length){var y=$("a[name="+window.location.hash.substring(1)+"]").parent().offset();"undefined"!==typeof y&&$("html, body").animate({scrollTop:y.top},300)}"/ci"!==window.location.pathname||sessionData.session.isLoggedIn||window.history.replaceState(null,"","/ci/recent");b.keydown(function(){setTimeout(m,50)});b.change(m);b.keyup(function(a){13===a.keyCode&&t.click()});f.keydown(function(){setTimeout(m,50)});f.change(m);
f.keyup(function(a){13===a.keyCode&&x.click()});h.keydown(function(){setTimeout(m,50)});h.change(m);h.keyup(function(a){13===a.keyCode&&u.click()});n.keydown(function(){setTimeout(m,50)});n.change(m);n.keyup(function(a){13===a.keyCode&&v.click()});q.keydown(function(){setTimeout(m,50)});q.change(m);q.keyup(function(a){13===a.keyCode&&w.click()});B.click(function(){window.location=getRelativeRootPath()+"ci/"+getLoginName()});A.click(function(){window.location=getRelativeRootPath()+"ci"});p.click(function(){window.location=
getRelativeRootPath()+"ci/recent"});x.click(function(){var a=$("#search-results");if(""===f.val())a.empty(),a.attr("hidden",!0);else{a.text("Loading Search Results...");var b={search:f.val()};ajax("search.ajax",{data:b,method:"POST",success:function(b){a.empty();a.html(b.html);a.attr("hidden",!1);$("#inputSearch").val("")},error:function(a,b,c){alert(c)}})}});t.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+b.val()});
u.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+b.val()+"/"+h.val()});v.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+b.val()+"/"+h.val()+"/"+n.val()});w.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+b.val()+"/"+h.val()+"/"+n.val()+"/"+$("#inputBuildClass").val()+
":"+q.val()});$("#rbp-dl-direct").click(function(a){confirm("This is a development build; it has not been reviewed and may contain dangerous code, including viruses. Do you still want to download this file?")||a.preventDefault()});$("#rbp-dl-as").click(function(){var a=this.getAttribute("data-rsr-id"),b=this.getAttribute("data-dl-name");confirm("This is a development build; it has not been reviewed and may contain dangerous code, including viruses. Do you still want to download this file?")&&(b=prompt("Filename to download with:",
b),null!==b&&(window.location=getRelativeRootPath()+"r/"+a+"/"+b))});$("#toggle-project-sub").click(function(){var a=this.getAttribute("data-project-id"),b=document.getElementById("select-project-sub").value,c=$("#project-subscribe");c.addClass("disabled");c.prop("onclick",null).off("click");ajax("ci.project.togglesub",{data:{projectId:a,level:b},success:function(){window.location.reload(!0)}})});var z=$("#enableRepoBuilds");(function(){var b=$("#toggle-orgs");0!==b.length&&(b.empty(),a(getLoginName(),
!1).appendTo(b),ghApi("user/orgs",{},"GET",function(c){for(var d=0;d<c.length;d++)a(c[d].login,!0).appendTo(b)}))})();z.dialog({autoOpen:!1,dialogClass:"no-close",closeOnEscape:!0,close:function(a){a.originalEvent&&$("#detailLoader").empty()},buttons:[{id:"confirm",text:"Confirm",click:function(){$("#confirm").attr("disabled",!0);c($(this),z)}}],modal:!0});p=$("#recentBuilds");16<p.find("> div").length&&"on"===getParameterByName("usePages",!1!==sessionData.opts.usePages?"on":"off")&&p.paginate({perPage:16,
scope:$("div")});p=$("#repo-list-build-wrapper");12<p.find("> div").length&&"on"===getParameterByName("usePages",!1!==sessionData.opts.usePages?"on":"off")&&p.paginate({perPage:12,scope:$("div")})});
