var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$(function(){function a(a,b){ajax("release.statechange",{data:{relId:releaseDetails.releaseId,state:a,message:b},method:"POST",success:function(){return location.reload(!0)}})}var b=$("<div></div>"),c=$("<textarea cols='80' rows='5'></textarea>").appendTo(b),h=$("<textarea cols='80' rows='5'></textarea>").appendTo(b),k=$("<textarea cols='80' rows='5'></textarea>").appendTo(b),e=$("<select></select>").append($("<option value='keep' selected>Keep</option>")).append($("<option value='rejected'>Rejected</option>")).append($("<option value='draft'>Draft</option>"));
b.append($("<div>Change state to: </div>").append(e));var m,n=$("<select></select>").appendTo(b);$("<button>Add</button>").click(function(){var a=h.val(),b=m[n.val()];a+="\n\n"+b.id+" &mdash; "+b.title+":\n> "+b.content;h.val(a)}).appendTo(b);ajax("submit.rules.api",{success:function(a){m=a;a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())rule=b.value,n.append($("<option></option>").attr("value",rule.id).text(rule.title))}});b.dialog({autoOpen:!1,position:modalPosition,modal:!0,buttons:{Post:function(){var b=
c.val()+"\n\n"+h.val()+"\n\n"+k.val()+"\n\n> This comment is posted here because this is the last commit when the released build was created.";ghApi(releaseDetails.rejectPath,{body:b},"POST",function(){switch(e.val()){case "rejected":a(PoggitConsts.ReleaseState.rejected,b);break;case "draft":a(PoggitConsts.ReleaseState.draft,b)}})}}});e.click(function(){var a=e.val();"rejected"===a?(c.val("Dear @"+releaseDetails.project.repo.owner+',\n> I regret to inform you that your plugin "**'+releaseDetails.name+
'**" (v'+releaseDetails.version+" submitted on "+(new Date(1E3*releaseDetails.created)).toISOString()+") has been rejected."),k.val("Please resolve these issues and submit the plugin again.")):"draft"===a&&(c.val('There are some problems with the plugin submission form for "**'+releaseDetails.name+'**" (v'+releaseDetails.version+" submitted on "+(new Date(1E3*releaseDetails.created)).toISOString()+"):"),k.val("Your release has been reset to draft. Please [edit the release](https://poggit.pmmp.io/edit/"+
releaseDetails.project.repo.owner+"/"+releaseDetails.project.repo.name+"/"+releaseDetails.project.name+"/"+releaseDetails.build.internal+') to resolve these problems, then click "Submit" on the edit page to have the plugin reviewed again.'))});var l=$("<select class='inline-select'></select>").change(function(){return a(l.val())}),f;for(f in PoggitConsts.ReleaseState)if(PoggitConsts.ReleaseState.hasOwnProperty(f)){var p=PoggitConsts.ReleaseState[f],q=$("<option></option>").attr("value",p).text(f.ucfirst());
q.prop("selected",releaseDetails.state===p);q.appendTo(l)}var g=$("<select></select>"),d;for(d in PoggitConsts.Staff)PoggitConsts.Staff.hasOwnProperty(d)&&PoggitConsts.Staff[d]>=PoggitConsts.AdminLevel.REVIEWER&&g.append($("<option></option>").attr("value",d).text(d));g.val(sessionData.session.loginName.toLowerCase());var r=$("<div></div>").append(g).dialog({autoOpen:!1,position:modalPosition,modal:!0,title:"Assign release",buttons:{Assign:function(){return ajax("review.assign",{data:{releaseId:releaseDetails.releaseId,
assignee:g.val()},success:function(){return window.location.reload()}})},Unassign:function(){return ajax("review.assign",{data:{releaseId:releaseDetails.releaseId,assignee:""},success:function(){return window.location.reload()}})}}});$("<div id='release-admin'></div>").append($("<span class='action'>Message</span>").click(function(){b.dialog("option","title","Message author");b.dialog("open")})).append(l).append($("<span class='action'>Assign</span>").click(function(){return r.dialog("open")})).insertAfter("#release-admin-marker")});
