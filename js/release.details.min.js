var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var f=a.length,g=0;g<f;g++){var h=a[g];if(b.call(c,h,g,a))return{i:g,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,f){if(b){c=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var g=a[f];g in c||(c[g]={});c=c[g]}a=a[a.length-1];f=c[a];b=b(f);b!=f&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var g=b.length,h=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var k=0;k<h&&c<g;)if(b[c++]!=a[k++])return!1;return k>=h}},"es6","es3");
$(function(){function a(){var a=$("#review-dialog").dialog({title:"Poggit Review",autoOpen:!1,position:modalPosition,modal:!0,buttons:{Cancel:function(){a.dialog("close")},"Post Review":function(){var b=$("#reviewcriteria").val(),l=sessionData.session.adminLevel>=PoggitConsts.AdminLevel.MODERATOR?1:2,c=releaseDetails.mainCategory,d=$("#votes").val(),e=$("#reviewmessage").val();addReview(releaseDetails.releaseId,"<?= Session::getInstance()->getName() ?>",b,l,c,d,e);a.dialog("close");return!0}},open:function(){$(".ui-widget-overlay").bind("click",
function(){$("#review-dialog").dialog("close")})},close:function(){b[0].reset()}});var b=a.find("form").on("submit",function(a){a.preventDefault()});$("#addreview").button().on("click",function(){a.dialog("open")})}var b=function(a){var b=a.attr("id"),c=[];a.find("a.anchor").each(function(){var a=$(this).addClass("dynamic-anchor").html("&sect;");a.appendTo(a.parent());var d=this.id.substring(13);c.push(d);var e=b+"-header-"+d;a.parent().attr("data-header-id",d);a.attr("name",e).attr("id","anchor-"+
e).attr("href","#"+e).removeAttr("aria-hidden");dynamicAnchor.call(this)});var l=[];a.find("a[name^='user-content-']").each(function(){var a=$(this);l.push(this.name.substring(13));a.attr("name",b+"-custom-"+a.attr("name"))});a.find("a[href]").each(function(){var a=$(this),d=a.attr("href");switch(/^https?:\/\//i.test(d)?"switchProtocol":d.startsWith("//")?"switchDomain":"/"===d.charAt(0)?"switchPath":"#"!==d.charAt(0)?"switchName":"switchAnchor"){case "switchAnchor":d.startsWith("#user-content-")?
(d=d.substring(14),-1!==c.indexOf(d)?a.attr("href","#"+b+"-header-"+d):-1!==l.indexOf(d)&&a.attr("href","#"+b+"-custom-"+d)):d.startsWith("#poggit-")?a.attr("href","#"+d.substring(8)):(d=d.substring(1),-1!==c.indexOf(d)?a.attr("href","#"+b+"-header-"+d):-1!==l.indexOf(d)&&a.attr("href","#"+b+"-custom-"+d));break;case "switchName":a.attr("href","https://github.com/"+releaseDetails.project.repo.owner+"/"+releaseDetails.project.repo.name+"/"+releaseDetails.build.tree+d);break;case "switchPath":a.attr("href",
"https://github.com"+d);break;case "switchDomain":a.attr("href","https:"+d)}})},c=function(a,b,f,g,h){var d=null,e;for(e in a)if(a.hasOwnProperty(e)&&b.children(a[e]).length>=f){d=a[e];break}if(null===d)return"The description has less than "+f+" headers.";a=a.slice(e+1);var l=[h+"general"],k=["General"];b.children(d).each(function(){var a=$(this);a.children("a.anchor.dynamic-anchor").remove();var b=a.attr("data-header-id");b||(b=String(Math.random()));l.push(h+b);k.push(a.text())});var n=Array(k.length);
for(e=0;e<l.length;++e)n[e]=$("<div class='release-description-tab-content'></div>").attr("id",l[e]).addClass(g?"release-description-tab-horizontal":"release-description-tab-vertical");e=0;b.contents().each(function(){this instanceof HTMLHeadingElement&&this.tagName.toLowerCase()===d?++e:n[e].append(this)});f=0===n[0].children().length;var m=$("<ul></ul>");for(e=0;e<l.length;++e)f&&0===e||m.append($("<li></li>").append($("<a></a>").attr("href","#"+l[e]).text(k[e].substr(0,35)+(35<k[e].length?"...":
""))));m=$("<div></div>").attr("id",h+"container").append(m);for(e=0;e<l.length;++e)f&&0===e||(g&&c(a,n[e],4,!1,l[e]+"-"),m.append(n[e]));m.tabs({orientation:g?"horizontal":"vertical"});b.html("").append(m);return null};$("#how-to-install").dialog({autoOpen:!1,modal:!0,position:modalPosition,open:function(a,b){$(".ui-widget-overlay").bind("click",function(){$("#how-to-install").dialog("close")})}});$("#release-description-bad-dialog").dialog({autoOpen:!1,position:modalPosition});var f=$("#release-description-content"),
g=$("#release-changelog-content");b(f);b(g);if(!1!==sessionData.opts.makeTabs){if(null!==getParameterByName("notabs",null)){$(".release-description").append($("<span class='colored-bullet yellow'></span>").css("cursor","pointer").click(function(){window.location=window.location.origin+window.location.pathname}).attr("title","Click to display description in tabs."));return}b=null;b="html"!==f.attr("data-desc-type")?"The plugin description is not in markdown format.":c("h1 h2 h3 h4 h5 h6".split(" "),
f,2,!0,"rel-desc-tabs-");null!==b?($("#release-description-bad-reason").html(b),$(".release-description").append($("<span class='colored-bullet red'></span>").css("cursor","pointer").attr("title","Failed to display description in tabs: "+b))):$(".release-description").append($("<span class='colored-bullet green'></span>").css("cursor","pointer").click(function(){window.location=window.location.origin+window.location.pathname+"?notabs"}).attr("title","Click to display description directly without splitting into tabs."))}"#shield-template"===
window.location.hash&&(alert("Thank you for submitting your plugin! Please have a look at the shields here and add them to the README on your repo."),window.location.hash="");var h=[],k=0;g.children("ul").children("li").each(function(){this.hasAttribute("data-disabled")&&h.push(k);k++});g.tabs({disabled:h});f=$("#release-authors");ghApi("users/"+f.attr("data-owner"),{},"GET",function(a){"User"===a.type&&(a=$("<li class='release-authors-entry'></li>").append($("<img/>").attr("src",a.avatar_url).attr("width",
"16")).append(" @"+a.login).append(generateGhLink(a.html_url)),$("<li>Owner</li>").append($("<ul class='plugin-info release-authors-sub'></ul>").append(a)).prependTo($("#release-authors-main")))});$("#license-dialog").dialog({position:modalPosition,modal:!0,height:.8*window.innerHeight,width:.8*window.innerWidth,autoOpen:!1,open:function(a,b){$(".ui-widget-overlay").bind("click",function(){$("#license-dialog").dialog("close")})}});releaseDetails.isMine||a();if(sessionData.session.isLoggedIn&&releaseDetails.state===
PoggitConsts.ReleaseState.checked){f=function(){var a=$("#votemessage").val();addVote(releaseDetails.releaseId,1,a);p.dialog("close");return!0};g={Cancel:function(){p.dialog("close")},Accept:f};0>=releaseDetails.myVote&&(g.Accept=f);var p=$("#voteup-dialog").dialog({title:"ACCEPT Plugin",autoOpen:!1,position:modalPosition,modal:!0,buttons:g,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#voteup-dialog").dialog("close")})},close:function(){r[0].reset()}});var r=p.find("form").on("submit",
function(a){a.preventDefault()});$("#upvote").button().on("click",function(){p.dialog("open")});var q=$("#votedown-dialog").dialog({title:"REJECT Plugin",autoOpen:!1,position:modalPosition,modal:!0,buttons:{Cancel:function(){q.dialog("close")},Reject:function(){var a=$("#votemessage").val();if(10>a.length)$("#vote-error").text("Please type at least 10 characters...");else return addVote(releaseDetails.releaseId,-1,a),q.dialog("close"),!0}},open:function(a,b){$(".ui-widget-overlay").bind("click",function(){$("#votedown-dialog").dialog("close")})},
close:function(){t[0].reset()}});var t=q.find("form").on("submit",function(a){a.preventDefault()});$("#downvote").button().on("click",function(){q.dialog("open")})}});
function deleteRelease(){var a={my:"center top",at:"center top+100",of:window};$("#dialog-confirm").dialog({resizable:!1,height:"auto",width:400,position:a,clickOut:!0,modal:!0,buttons:{"Delete Forever":function(){$(this).dialog("close");ajax("release.statechange",{data:{relId:releaseDetails.releaseId,action:"delete"},method:"POST",success:function(){location.replace(getRelativeRootPath()+("p/"+releaseDetails.name+"/"+releaseDetails.version))},error:function(){location.replace(getRelativeRootPath()+
("p/"+releaseDetails.name+"/"+releaseDetails.version))}})},Cancel:function(){$(this).dialog("close")}},open:function(a,c){$(".ui-widget-overlay").bind("click",function(){$("#dialog-confirm").dialog("close")})}})}
function addReview(a,b,c,f,g,h,k){ajax("review.admin",{data:{relId:a,user:b,criteria:c,type:f,category:g,score:h,message:k,action:"add"},method:"POST",success:function(){location.replace(getRelativeRootPath()+("p/"+releaseDetails.name+"/"+releaseDetails.version))},error:function(){location.replace(getRelativeRootPath()+("p/"+releaseDetails.name+"/"+releaseDetails.version))}})}
function addVote(a,b,c){ajax("release.vote",{data:{relId:a,vote:b,message:c},method:"POST",success:function(){location.replace(getRelativeRootPath()+("p/"+releaseDetails.name+"/"+releaseDetails.version))},error:function(a){location.replace(getRelativeRootPath()+("p/"+releaseDetails.name+"/"+releaseDetails.version))}})};
