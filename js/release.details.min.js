var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,g=0;g<e;g++){var h=a[g];if(b.call(c,h,g,a))return{i:g,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var g=a[e];g in c||(c[g]={});c=c[g]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var e=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var b=e.length,h=a.length;c=Math.max(0,Math.min(c|0,e.length));for(var k=0;k<h&&c<b;)if(e[c++]!=a[k++])return!1;return k>=h}},"es6","es3");
$(function(){function a(){var a=$("#review-dialog").dialog({title:"Poggit Review",autoOpen:!1,height:380,width:250,position:modalPosition,modal:!0,buttons:{Cancel:function(){a.dialog("close")},"Post Review":function(){var l=$("#reviewcriteria").val(),c=sessionData.session.adminLevel>=PoggitConsts.AdminLevel.MODERATOR?1:2,b=releaseDetails.mainCategory,f=$("#votes").val(),d=$("#reviewmessage").val();addReview(releaseDetails.releaseId,"<?= Session::getInstance()->getName() ?>",l,c,b,f,d);a.dialog("close");
return!0}},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#review-dialog").dialog("close")})},close:function(){c[0].reset()}});var c=a.find("form").on("submit",function(a){a.preventDefault()});$("#addreview").button().on("click",function(){a.dialog("open")})}var b=function(a){var c=a.attr("id"),l=[];a.find("a.anchor").each(function(){var a=$(this).addClass("dynamic-anchor").html("&sect;");a.appendTo(a.parent());var b=this.id.substring(13);l.push(b);var d=c+"-header-"+b;a.parent().attr("data-header-id",
b);a.attr("name",d).attr("id","anchor-"+d).attr("href","#"+d).removeAttr("aria-hidden");dynamicAnchor.call(this)});var b=[];a.find("a[name^='user-content-']").each(function(){var a=$(this);b.push(this.name.substring(13));a.attr("name",c+"-custom-"+a.attr("name"))});a.find("a[href]").each(function(){var a=$(this),f=a.attr("href");switch(/^https?:\/\//i.test(f)?"switchProtocol":f.startsWith("//")?"switchDomain":"/"===f.charAt(0)?"switchPath":"#"!==f.charAt(0)?"switchName":"switchAnchor"){case "switchAnchor":f.startsWith("#user-content-")?
(f=f.substring(14),-1!==l.indexOf(f)?a.attr("href","#"+c+"-header-"+f):-1!==b.indexOf(f)&&a.attr("href","#"+c+"-custom-"+f)):f.startsWith("#poggit-")?a.attr("href","#"+f.substring(8)):(f=f.substring(1),-1!==l.indexOf(f)?a.attr("href","#"+c+"-header-"+f):-1!==b.indexOf(f)&&a.attr("href","#"+c+"-custom-"+f));break;case "switchName":a.attr("href","https://github.com/"+releaseDetails.project.repo.owner+"/"+releaseDetails.project.repo.name+"/"+releaseDetails.build.tree+f);break;case "switchPath":a.attr("href",
"https://github.com"+f);break;case "switchDomain":a.attr("href","https:"+f)}})},c=function(a,b,e,g,h){var f=null,d;for(d in a)if(a.hasOwnProperty(d)&&b.children(a[d]).length>=e){f=a[d];break}if(null===f)return"The description has less than "+e+" headers.";a=a.slice(d+1);var l=[h+"general"],k=["General"];b.children(f).each(function(){var a=$(this);a.children("a.anchor.dynamic-anchor").remove();var b=a.attr("data-header-id");b||(b=String(Math.random()));l.push(h+b);k.push(a.text())});var n=Array(k.length);
for(d=0;d<l.length;++d)n[d]=$("<div class='release-description-tab-content'></div>").attr("id",l[d]).addClass(g?"release-description-tab-horizontal":"release-description-tab-vertical");d=0;b.contents().each(function(){this instanceof HTMLHeadingElement&&this.tagName.toLowerCase()===f?++d:n[d].append(this)});e=0===n[0].children().length;var m=$("<ul></ul>");for(d=0;d<l.length;++d)e&&0===d||m.append($("<li></li>").append($("<a></a>").attr("href","#"+l[d]).text(k[d].substr(0,40)+(40<k[d].length?"...":
""))));m=$("<div></div>").attr("id",h+"container").append(m);for(d=0;d<l.length;++d)e&&0===d||(g&&c(a,n[d],4,!1,l[d]+"-"),m.append(n[d]));m.tabs({orientation:g?"horizontal":"vertical"});b.html("").append(m);return null};$("#how-to-install").dialog({autoOpen:!1,modal:!0,position:modalPosition,open:function(a,b){$(".ui-widget-overlay").bind("click",function(){$("#how-to-install").dialog("close")})}});$("#release-description-bad-dialog").dialog({autoOpen:!1,position:modalPosition});var e=$("#release-description-content"),
g=$("#release-changelog-content");b(e);b(g);if(!1!==sessionData.opts.makeTabs){if(null!==getParameterByName("notabs",null)){$(".release-description").append($("<span class='colored-bullet yellow'></span>").css("cursor","pointer").click(function(){window.location=window.location.origin+window.location.pathname}).attr("title","Click to display description in tabs."));return}b=null;b="html"!==e.attr("data-desc-type")?"The plugin description is not in markdown format.":c("h1 h2 h3 h4 h5 h6".split(" "),
e,2,!0,"rel-desc-tabs-");null!==b?($("#release-description-bad-reason").html(b),$(".release-description").append($("<span class='colored-bullet red'></span>").css("cursor","pointer").attr("title","Failed to display description in tabs: "+b))):$(".release-description").append($("<span class='colored-bullet green'></span>").css("cursor","pointer").click(function(){window.location=window.location.origin+window.location.pathname+"?notabs"}).attr("title","Click to display description directly without splitting into tabs."))}var h=
[],k=0;g.children("ul").children("li").each(function(){this.hasAttribute("data-disabled")&&h.push(k);k++});g.tabs({disabled:h});e=$("#release-authors");e.find(".release-authors-entry").each(function(){var a=$(this),b=a.attr("data-name");ghApi("users/"+b,{},"GET",function(b){null!==b.name&&(b=$("<span class='release-author-realname'></span>").text("("+b.name+")"),a.append(b))})});ghApi("users/"+e.attr("data-owner"),{},"GET",function(a){if("User"===a.type){var b=$("<li></li>").append($("<img/>").attr("src",
a.avatar_url).attr("width","16")).append("@"+a.login).append($("<a></a>").attr("href",a.html_url).attr("target","_blank").append($("<img class='gh-logo'/>").attr("src",getRelativeRootPath()+"res/ghMark.png").attr("width","16")));null!==a.name&&b.append("&nbsp;").append($("<span class='release-author-realname'></span>").text("("+a.name+")"));$("<li>Owner</li>").append($("<ul></ul>").append(b)).prependTo($("#release-authors-main"))}});$("#license-dialog").dialog({position:modalPosition,height:.8*window.innerHeight,
width:.8*window.innerWidth,autoOpen:!1});releaseDetails.isMine||a();if(sessionData.session.isLoggedIn&&releaseDetails.state===PoggitConsts.ReleaseState.checked){e=function(){var a=$("#votemessage").val();addVote(releaseDetails.releaseId,1,a);p.dialog("close");return!0};g={Cancel:function(){p.dialog("close")},Accept:e};0>=releaseDetails.myVote&&(g.Accept=e);var p=$("#voteup-dialog").dialog({title:"ACCEPT Plugin",autoOpen:!1,height:300,width:250,position:modalPosition,modal:!0,buttons:g,open:function(){$(".ui-widget-overlay").bind("click",
function(){$("#voteup-dialog").dialog("close")})},close:function(){r[0].reset()}});var r=p.find("form").on("submit",function(a){a.preventDefault()});$("#upvote").button().on("click",function(){p.dialog("open")});var q=$("#votedown-dialog").dialog({title:"REJECT Plugin",autoOpen:!1,height:380,width:250,position:modalPosition,modal:!0,buttons:{Cancel:function(){q.dialog("close")},Reject:function(){var a=$("#votemessage").val();if(10>a.length)$("#vote-error").text("Please type at least 10 characters...");
else return addVote(releaseDetails.releaseId,-1,a),q.dialog("close"),!0}},open:function(a,b){$(".ui-widget-overlay").bind("click",function(){$("#votedown-dialog").dialog("close")})},close:function(){t[0].reset()}});var t=q.find("form").on("submit",function(a){a.preventDefault()});$("#downvote").button().on("click",function(){q.dialog("open")})}});
function updateRelease(){var a=$("#setStatus").val();ajax("release.statechange",{data:{relId:releaseDetails.releaseId,state:a},method:"POST",success:function(){location.reload(!0)}})}
function deleteRelease(){var a={my:"center top",at:"center top+100",of:window};$("#dialog-confirm").dialog({resizable:!1,height:"auto",width:400,position:a,clickOut:!0,modal:!0,buttons:{"Delete Forever":function(){$(this).dialog("close");ajax("release.statechange",{data:{relId:releaseDetails.releaseId,action:"delete"},method:"POST",success:function(){location.reload(!0)},error:function(){location.reload(!0)}})},Cancel:function(){$(this).dialog("close")}},open:function(a,c){$(".ui-widget-overlay").bind("click",
function(){$("#dialog-confirm").dialog("close")})}})}function addReview(a,b,c,e,g,h,k){ajax("review.admin",{data:{relId:a,user:b,criteria:c,type:e,category:g,score:h,message:k,action:"add"},method:"POST",success:function(){location.reload(!0)},error:function(){location.reload(!0)}})}function addVote(a,b,c){ajax("release.vote",{data:{relId:a,vote:b,message:c},method:"POST",success:function(){location.reload(!0)},error:function(a){location.reload(!0)}})};
