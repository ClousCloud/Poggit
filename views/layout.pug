doctype html

mixin qjs(file)
	- js.add("js", "legacy", file, "js")
mixin qts(file)
	- js.add("ts", "public", file, "js")

html(lang="en")
	head(prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#")
		title= pageInfo.title
		meta(name="description", content=pageInfo.description)
		meta(name="keywords", content=pageInfo.keywords.join(","))

		meta(property="og:site_name", content="Poggit")
		meta(property="og:image", content="https://poggit.pmmp.io/res/poggit.png")
		meta(property="og:type", content=pageInfo.type)
		meta(property="og:url", content=pageInfo.url)

		meta(name="twitter:card", content="summary")
		meta(name="twitter:site", content="poggitci")
		meta(name="twitter:title", content=pageInfo.title)
		meta(name="twitter:description", content=pageInfo.description)

		meta(name="viewport", content="width=device-width, initial-scale=1, shrink-to-fit=no")
		meta(name="theme-color", content="#292b2c")
		meta(name="apple-mobile-web-capable", content="yes")

		link(rel="stylesheet", href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css")
		link(rel="stylesheet", href="https://code.jquery.com/ui/jquery-ui-git.css")
		!= css("style")

		unless secrets.meta.debug
			script.
				(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
				ga("create", "UA-93677016-1", "auto");
				ga("set", "dimension1", !{sessionData.session.isLoggedIn ? "Member" : "Guest"});
				ga("set", "dimension2", !{PoggitConsts.AdminLevel[sessionData.session.adminLevel]});
				ga("send", "pageview");

		script.
			var sessionData = !{JSON.stringify(sessionData)}
			var PoggitConsts = !{JSON.stringify(PoggitConsts)} // TODO make this cacheable

	body
		#header.container-fluid
			nav.navbar.navbar-toggleable-md.navbar-inverse.bg-inverse.fixed-top(role="navigation")
				.tabletlogo
					.navbar-brand.tm
						a(href="/")
							img.logo(src="/res/poggit.png")
							| Poggit
							sub.poggit-edition 2.0
					button.navbar-toggler.navbar-toggler-right.mr-auto(type="button", data-toggle="collapse", data-target="#navbarNavAltMarkup", aria-controls="navbarNavAltMarkup", aria-expanded="false", aria-label="Toggle navigation")
						span.navbar-toggler-icon
				#navbarNavAltMarkup.navbar-right.navbuttons.collapse.navbar-collapse
					.navbar-middle
						ul.navbar-nav.navbuttons.collapse.navbar-collapse
							li.nav-item.navbutton(data-target="") Home
							li.nav-item.navbutton(data-target="plugins") Release
							li.nav-item.navbutton(data-target="ci/recent") Dev
							if sessionData.session.isLoggedIn
								li.nav-item.navbutton(data-target="review") Review
					ul.navbar-nav
						if sessionData.session.isLoggedIn
							li.nav-item.login-buttons: span(onclick="location.assign('settings');") Settings
							li.nav-item.login-buttons: span#nav-logout Logout
							div: a(target="_blank", href=`https://github.com/${sessionData.session.loginName}?tab=repositories`)
								img(width=20, height=20, src=`https://github.com/${sessionData.session.loginName}.png`)/
						else
							li.nav-item.login-buttons: span(onclick="login()") Login with GitHub

		#body
			unless sessionData.tosHidden
				#remind-tos
					p By continuing to use this site, you agree to the #[a(href="/tos") Terms of Service] of this website, including the use of cookies.
					p: span.action#hide-tos-button OK, don't show this again
			block content

		#footer
			ul.footer-navbar
				li Powered by Poggit 2.0
				li#online-user-count
				li!= `&copy; ${new Date().getFullYear()} Poggit`
				span#flat-cp Some icons by www.freepik.com
			ul.footer-navbar
				li: a(target="_blank", href="/tos") Terms of Service
				li: a(target="_blank", href="!{secrets.discord.serverInvite}") Discord
				li: a(target="_blank", href="https://github.com/poggit/poggit") Source Code
				li: a(target="_blank", href="https://github.com/poggit/poggit/issues") Report Bugs
				li: a.twitter-follow-button(href="https://twitter.com/poggitci", data-show-screen-name="false", data-show-count="true") Follow @poggitci
				li: a(href="#", onclick="$('html, body').animate({scrollTop: 0}, 500);") Back to top

		script(async, charset="utf-8", src="//platform.twitter.com/widgets.js")
		script(src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js")
		script(src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js")
		script(src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js")
		+qts("client")
		div!= js.flush(pageInfo.resSalt)
		block tail_scripts
